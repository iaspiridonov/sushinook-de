function cartChange(t,a,n){if(0==a)return!1;var e="/ru/cart/change";"combo"==n&&(e="/ru/cart/combochange"),"half"==n&&(e="/ru/cart/halfpizzachange"),$.ajax({type:"POST",url:e,data:{id:t,count:a},dataType:"html",success:function(t){}})}!function(){var t=$('[data-role="cart-popup"]');if(!t.length)return!1;var a,n=t.find('[data-role="slider"]'),e=function(){var n=0;t.find('[data-role="item"]').each(function(){var t=$(this),a=parseFloat(t.find('[name="price"]').val(),10),e=t.find('[name="count"]'),i=parseInt(e.val(),10),o=a*i,d=t.data("id"),r=t.data("type");n+=o,t.find('[data-output="count"]').text(i).end().find('[data-output="amount"]').text(number_format(o,2,"."," ")).end().find('[data-button="minus"]').attr("disabled",1==i),cartChange(d,i,r),e.val(i)}),t.find('[data-output="result"]').text(number_format(n,2,"."," ")),o(),a&&a.update()},i=function(){a&&n.removeClass("start end").addClass(a.isBeginning?"start":"").addClass(a.isEnd?"end":"")},o=function(){t.find('[data-role="scroll"]').nanoScroller({alwaysVisible:!0})};n.length&&(a=new Swiper(n,{loop:!1,speed:600,slideActiveClass:"active",lazy:!0,navigation:{nextEl:".btn--popup-next",prevEl:".btn--popup-prev",disabledClass:"disabled"},on:{init:function(){i(),setTimeout(function(){i()},200)}}})).on("slideChange",function(){i()}).on("lazyImageReady",function(t,a){$(t).addClass("loaded")}),o(),e(),t.delegate('[data-button="minus"]',"click",function(){var t=$(this).parents('[data-role="item"]').find('[name="count"]'),a=parseInt(t.val(),10);a--,t.val(a),e()}).delegate('[data-button="plus"]',"click",function(){var t=$(this).parents('[data-role="item"]').find('[name="count"]'),a=parseInt(t.val(),10);a++,t.val(a),e()}).delegate('[data-button="remove"]',"click",function(){$(this).parents('[data-role="item"]').slideUp(function(){$(this).remove(),e()})}),$(".cart-popup-wrapper").on("mouseenter",function(){$(document).trigger("itemLoadedEvent"),e()})}(),function(){var t=$('[data-form="reg"]').find("form");if(!t.length)return!1;t.find("[data-inputmask]").inputmask({showMaskOnHover:!1,placeholder:"_"})}(),function(){var t=$('[data-form="profile"]').find("form");if(!t.length)return!1;t.find("[data-inputmask]").inputmask({showMaskOnHover:!1,placeholder:"_"})}(),function(){var t=$('[data-form="feedback"]').find("form");if(!t.length)return!1;t.find("[data-inputmask]").inputmask({showMaskOnHover:!1,placeholder:"_"})}(),function(){var t=$('[data-form="cart"]').find("form");if(!t.length)return!1;var a=t.find('[data-output="result"]'),n=function(){var n=0;t.find('[data-role="item"]').each(function(){var t=$(this),a=t.data("price"),e=t.attr("data-count"),i=a*e;n+=i,t.find('[data-output="count"]').text(e).end().find('[data-output="amount"]').text(number_format(i,2,"."," ")),t.find('[data-button="minus"]').attr("disabled",1==e)}),a.text(number_format(n,2,"."," "))};n(),t.find('[data-role="item"]').each(function(){var t=$(this),a=t.data("count");t.find('[data-button="remove"]').on("click",function(){t.remove(),n()}).end().find('[data-button="minus"]').on("click",function(){a--,t.attr("data-count",a),n()}).end().find('[data-button="plus"]').on("click",function(){a++,t.attr("data-count",a),n()})}),$("[data-step]").on("click",function(){var t=$(this).data("step");$('[data-role="cart"]').find('[aria-controls="'+t+'"]').tab("show")})}(),function(){var t=$('[data-form="order"]').find("form");if(!t.length)return!1;t.find("[data-inputmask]").inputmask({showMaskOnHover:!1,placeholder:"_"});var a=function(){var a=t.find('[name="delivery"]').filter(":checked").data("type");t.find("[data-delivery]").hide().filter('[data-delivery="'+a+'"]').show()};a(),t.find('[name="delivery"]').on("change",function(){a()})}();